<!DOCTYPE html>
<html>
<head>
<title>Admin Dashboard</title>
<style>
body{margin:0;font-family:Segoe UI;background:#f4f6fb}
.sidebar{
  position:fixed;left:0;top:0;width:220px;height:100%;
  background:#2c3e50;color:white;padding:20px
}
.main{margin-left:240px;padding:25px}
.card{
  background:white;padding:20px;border-radius:10px;
  box-shadow:0 5px 20px rgba(0,0,0,.1)
}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #ddd}
th{background:#1abc9c;color:white}
.loading{display:none;margin:10px 0}
.spinner{
  width:20px;height:20px;border:3px solid #ccc;
  border-top:3px solid #1abc9c;border-radius:50%;
  animation:spin 1s linear infinite;display:inline-block
}
@keyframes spin{100%{transform:rotate(360deg)}}
button{padding:8px 12px;border:none;border-radius:6px;cursor:pointer}
.logout{background:#e74c3c;color:white;width:100%}
</style>
</head>
<body>

<div class="sidebar">
  <h2>üëë Admin</h2>
  <p>Manajemen Anggota</p>
  <button class="logout" onclick="logout()">üîÅ Ganti User</button>
</div>

<div class="main">
  <div class="card">
    <h3>üìã Data Anggota</h3>

    <select id="limit">
      <option value="100">100</option>
      <option value="500">500</option>
      <option value="1000">1000</option>
    </select>
    <button onclick="load()">Tampilkan</button>

    <div class="loading" id="loading">
      <span class="spinner"></span> Memuat data...
    </div>

    <table>
      <thead>
        <tr><th>NIM</th><th>Nama</th><th>Email</th><th>No HP</th><th>Alamat</th></tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<script>
if(localStorage.getItem('role')!=='admin')location.href='/login.html';

function logout(){
  localStorage.clear();location.href='/login.html';
}
async function load(){
  loading.style.display='block';
  const limit=limit.value;
  const res=await fetch(`/admin/anggota?limit=${limit}`,{
    headers:{'x-role':'admin'}
  });
  const json=await res.json();
  tbody.innerHTML='';
  json.data.forEach(a=>{
    tbody.innerHTML+=`
      <tr><td>${a.nim}</td><td>${a.nama}</td>
      <td>${a.email}</td><td>${a.no_hp}</td><td>${a.alamat}</td></tr>`;
  });
  loading.style.display='none';
}
</script>
</body>
</html>
